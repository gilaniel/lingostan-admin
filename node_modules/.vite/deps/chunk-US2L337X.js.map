{
  "version": 3,
  "sources": ["../../@react-aria/form/dist/packages/@react-aria/form/src/useFormValidation.ts", "../../@react-aria/label/dist/packages/@react-aria/label/src/useLabel.ts", "../../@react-aria/label/dist/packages/@react-aria/label/src/useField.ts"],
  "sourcesContent": ["/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {FormValidationState} from '@react-stately/form';\nimport {RefObject, Validation, ValidationResult} from '@react-types/shared';\nimport {setInteractionModality} from '@react-aria/interactions';\nimport {useEffect, useRef} from 'react';\nimport {useEffectEvent, useLayoutEffect} from '@react-aria/utils';\n\ntype ValidatableElement = HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement;\n\ninterface FormValidationProps<T> extends Validation<T> {\n  focus?: () => void\n}\n\nexport function useFormValidation<T>(props: FormValidationProps<T>, state: FormValidationState, ref: RefObject<ValidatableElement | null> | undefined): void {\n  let {validationBehavior, focus} = props;\n\n  // This is a useLayoutEffect so that it runs before the useEffect in useFormValidationState, which commits the validation change.\n  useLayoutEffect(() => {\n    if (validationBehavior === 'native' && ref?.current && !ref.current.disabled) {\n      let errorMessage = state.realtimeValidation.isInvalid ? state.realtimeValidation.validationErrors.join(' ') || 'Invalid value.' : '';\n      ref.current.setCustomValidity(errorMessage);\n\n      // Prevent default tooltip for validation message.\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=605277\n      if (!ref.current.hasAttribute('title')) {\n        ref.current.title = '';\n      }\n\n      if (!state.realtimeValidation.isInvalid) {\n        state.updateValidation(getNativeValidity(ref.current));\n      }\n    }\n  });\n\n  let isIgnoredReset = useRef(false);\n  let onReset = useEffectEvent(() => {\n    if (!isIgnoredReset.current) {\n      state.resetValidation();\n    }\n  });\n\n  let onInvalid = useEffectEvent((e: Event) => {\n    // Only commit validation if we are not already displaying one.\n    // This avoids clearing server errors that the user didn't actually fix.\n    if (!state.displayValidation.isInvalid) {\n      state.commitValidation();\n    }\n\n    // Auto focus the first invalid input in a form, unless the error already had its default prevented.\n    let form = ref?.current?.form;\n    if (!e.defaultPrevented && ref && form && getFirstInvalidInput(form) === ref.current) {\n      if (focus) {\n        focus();\n      } else {\n        ref.current?.focus();\n      }\n\n      // Always show focus ring.\n      setInteractionModality('keyboard');\n    }\n\n    // Prevent default browser error UI from appearing.\n    e.preventDefault();\n  });\n\n  let onChange = useEffectEvent(() => {\n    state.commitValidation();\n  });\n\n  useEffect(() => {\n    let input = ref?.current;\n    if (!input) {\n      return;\n    }\n\n    let form = input.form;\n\n    let reset = form?.reset;\n    if (form) {\n      // Try to detect React's automatic form reset behavior so we don't clear\n      // validation errors that are returned by server actions.\n      // To do this, we ignore programmatic form resets that occur outside a user event.\n      // This is best-effort. There may be false positives, e.g. setTimeout.\n      form.reset = () => {\n        // React uses MessageChannel for scheduling, so ignore 'message' events.\n        isIgnoredReset.current = !window.event || (window.event.type === 'message' && window.event.target instanceof MessagePort);\n        reset?.call(form);\n        isIgnoredReset.current = false;\n      };\n    }\n\n    input.addEventListener('invalid', onInvalid);\n    input.addEventListener('change', onChange);\n    form?.addEventListener('reset', onReset);\n    return () => {\n      input!.removeEventListener('invalid', onInvalid);\n      input!.removeEventListener('change', onChange);\n      form?.removeEventListener('reset', onReset);\n      if (form) {\n        // @ts-ignore\n        form.reset = reset;\n      }\n    };\n  }, [ref, onInvalid, onChange, onReset, validationBehavior]);\n}\n\nfunction getValidity(input: ValidatableElement) {\n  // The native ValidityState object is live, meaning each property is a getter that returns the current state.\n  // We need to create a snapshot of the validity state at the time this function is called to avoid unpredictable React renders.\n  let validity = input.validity;\n  return {\n    badInput: validity.badInput,\n    customError: validity.customError,\n    patternMismatch: validity.patternMismatch,\n    rangeOverflow: validity.rangeOverflow,\n    rangeUnderflow: validity.rangeUnderflow,\n    stepMismatch: validity.stepMismatch,\n    tooLong: validity.tooLong,\n    tooShort: validity.tooShort,\n    typeMismatch: validity.typeMismatch,\n    valueMissing: validity.valueMissing,\n    valid: validity.valid\n  };\n}\n\nfunction getNativeValidity(input: ValidatableElement): ValidationResult {\n  return {\n    isInvalid: !input.validity.valid,\n    validationDetails: getValidity(input),\n    validationErrors: input.validationMessage ? [input.validationMessage] : []\n  };\n}\n\nfunction getFirstInvalidInput(form: HTMLFormElement): ValidatableElement | null {\n  for (let i = 0; i < form.elements.length; i++) {\n    let element = form.elements[i] as ValidatableElement;\n    if (!element.validity.valid) {\n      return element;\n    }\n  }\n\n  return null;\n}\n", "/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {AriaLabelingProps, DOMAttributes, DOMProps, LabelableProps} from '@react-types/shared';\nimport {ElementType, LabelHTMLAttributes} from 'react';\nimport {useId, useLabels} from '@react-aria/utils';\n\nexport interface LabelAriaProps extends LabelableProps, DOMProps, AriaLabelingProps {\n  /**\n   * The HTML element used to render the label, e.g. 'label', or 'span'.\n   * @default 'label'\n   */\n  labelElementType?: ElementType\n}\n\nexport interface LabelAria {\n  /** Props to apply to the label container element. */\n  labelProps: DOMAttributes | LabelHTMLAttributes<HTMLLabelElement>,\n  /** Props to apply to the field container element being labeled. */\n  fieldProps: AriaLabelingProps & DOMProps\n}\n\n/**\n * Provides the accessibility implementation for labels and their associated elements.\n * Labels provide context for user inputs.\n * @param props - The props for labels and fields.\n */\nexport function useLabel(props: LabelAriaProps): LabelAria {\n  let {\n    id,\n    label,\n    'aria-labelledby': ariaLabelledby,\n    'aria-label': ariaLabel,\n    labelElementType = 'label'\n  } = props;\n\n  id = useId(id);\n  let labelId = useId();\n  let labelProps = {};\n  if (label) {\n    ariaLabelledby = ariaLabelledby ? `${labelId} ${ariaLabelledby}` : labelId;\n    labelProps = {\n      id: labelId,\n      htmlFor: labelElementType === 'label' ? id : undefined\n    };\n  } else if (!ariaLabelledby && !ariaLabel && process.env.NODE_ENV !== 'production') {\n    console.warn('If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility');\n  }\n\n  let fieldProps = useLabels({\n    id,\n    'aria-label': ariaLabel,\n    'aria-labelledby': ariaLabelledby\n  });\n\n  return {\n    labelProps,\n    fieldProps\n  };\n}\n", "/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {DOMAttributes, HelpTextProps, Validation} from '@react-types/shared';\nimport {LabelAria, LabelAriaProps, useLabel} from './useLabel';\nimport {mergeProps, useSlotId} from '@react-aria/utils';\n\nexport interface AriaFieldProps extends LabelAriaProps, HelpTextProps, Omit<Validation<any>, 'isRequired'> {}\n\nexport interface FieldAria extends LabelAria {\n  /** Props for the description element, if any. */\n  descriptionProps: DOMAttributes,\n  /** Props for the error message element, if any. */\n  errorMessageProps: DOMAttributes\n}\n\n/**\n * Provides the accessibility implementation for input fields.\n * Fields accept user input, gain context from their label, and may display a description or error message.\n * @param props - Props for the Field.\n */\nexport function useField(props: AriaFieldProps): FieldAria {\n  let {description, errorMessage, isInvalid, validationState} = props;\n  let {labelProps, fieldProps} = useLabel(props);\n\n  let descriptionId = useSlotId([Boolean(description), Boolean(errorMessage), isInvalid, validationState]);\n  let errorMessageId = useSlotId([Boolean(description), Boolean(errorMessage), isInvalid, validationState]);\n\n  fieldProps = mergeProps(fieldProps, {\n    'aria-describedby': [\n      descriptionId,\n      // Use aria-describedby for error message because aria-errormessage is unsupported using VoiceOver or NVDA. See https://github.com/adobe/react-spectrum/issues/1346#issuecomment-740136268\n      errorMessageId,\n      props['aria-describedby']\n    ].filter(Boolean).join(' ') || undefined\n  });\n\n  return {\n    labelProps,\n    fieldProps,\n    descriptionProps: {\n      id: descriptionId\n    },\n    errorMessageProps: {\n      id: errorMessageId\n    }\n  };\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAwBO,SAAS,0CAAqB,OAA+B,OAA4B,KAAqD;AACnJ,MAAI,EAAA,oBAAmB,MAAO,IAAI;AAGlC,GAAA,GAAA,2CAAgB,MAAA;AACd,QAAI,uBAAuB,aAAY,QAAA,QAAA,QAAA,SAAA,SAAA,IAAK,YAAW,CAAC,IAAI,QAAQ,UAAU;AAC5E,UAAI,eAAe,MAAM,mBAAmB,YAAY,MAAM,mBAAmB,iBAAiB,KAAK,GAAA,KAAQ,mBAAmB;AAClI,UAAI,QAAQ,kBAAkB,YAAA;AAI9B,UAAI,CAAC,IAAI,QAAQ,aAAa,OAAA,EAC5B,KAAI,QAAQ,QAAQ;AAGtB,UAAI,CAAC,MAAM,mBAAmB,UAC5B,OAAM,iBAAiB,wCAAkB,IAAI,OAAO,CAAA;IAExD;EACF,CAAA;AAEA,MAAI,kBAAiB,GAAA,aAAAA,QAAO,KAAA;AAC5B,MAAI,WAAU,GAAA,2CAAe,MAAA;AAC3B,QAAI,CAAC,eAAe,QAClB,OAAM,gBAAe;EAEzB,CAAA;AAEA,MAAI,aAAY,GAAA,2CAAe,CAAC,MAAA;QAQnB;AALX,QAAI,CAAC,MAAM,kBAAkB,UAC3B,OAAM,iBAAgB;AAIxB,QAAI,OAAO,QAAA,QAAA,QAAA,SAAA,UAAA,eAAA,IAAK,aAAO,QAAZ,iBAAA,SAAA,SAAA,aAAc;AACzB,QAAI,CAAC,EAAE,oBAAoB,OAAO,QAAQ,2CAAqB,IAAA,MAAU,IAAI,SAAS;UAIlF;AAHF,UAAI,MACF,OAAA;YAEA,gBAAA,IAAI,aAAO,QAAX,kBAAA,SAAA,SAAA,cAAa,MAAK;AAIpB,OAAA,GAAA,2CAAuB,UAAA;IACzB;AAGA,MAAE,eAAc;EAClB,CAAA;AAEA,MAAI,YAAW,GAAA,2CAAe,MAAA;AAC5B,UAAM,iBAAgB;EACxB,CAAA;AAEA,GAAA,GAAA,aAAAC,WAAU,MAAA;AACR,QAAI,QAAQ,QAAA,QAAA,QAAA,SAAA,SAAA,IAAK;AACjB,QAAI,CAAC,MACH;AAGF,QAAI,OAAO,MAAM;AAEjB,QAAI,QAAQ,SAAA,QAAA,SAAA,SAAA,SAAA,KAAM;AAClB,QAAI;AAKF,WAAK,QAAQ,MAAA;AAEX,uBAAe,UAAU,CAAC,OAAO,SAAU,OAAO,MAAM,SAAS,aAAa,OAAO,MAAM,kBAAkB;AAC7G,kBAAA,QAAA,UAAA,SAAA,SAAA,MAAO,KAAK,IAAA;AACZ,uBAAe,UAAU;MAC3B;AAGF,UAAM,iBAAiB,WAAW,SAAA;AAClC,UAAM,iBAAiB,UAAU,QAAA;AACjC,aAAA,QAAA,SAAA,SAAA,SAAA,KAAM,iBAAiB,SAAS,OAAA;AAChC,WAAO,MAAA;AACL,YAAO,oBAAoB,WAAW,SAAA;AACtC,YAAO,oBAAoB,UAAU,QAAA;AACrC,eAAA,QAAA,SAAA,SAAA,SAAA,KAAM,oBAAoB,SAAS,OAAA;AACnC,UAAI;AAEF,aAAK,QAAQ;IAEjB;EACF,GAAG;IAAC;IAAK;IAAW;IAAU;IAAS;GAAmB;AAC5D;AAEA,SAAS,kCAAY,OAAyB;AAG5C,MAAI,WAAW,MAAM;AACrB,SAAO;IACL,UAAU,SAAS;IACnB,aAAa,SAAS;IACtB,iBAAiB,SAAS;IAC1B,eAAe,SAAS;IACxB,gBAAgB,SAAS;IACzB,cAAc,SAAS;IACvB,SAAS,SAAS;IAClB,UAAU,SAAS;IACnB,cAAc,SAAS;IACvB,cAAc,SAAS;IACvB,OAAO,SAAS;EAClB;AACF;AAEA,SAAS,wCAAkB,OAAyB;AAClD,SAAO;IACL,WAAW,CAAC,MAAM,SAAS;IAC3B,mBAAmB,kCAAY,KAAA;IAC/B,kBAAkB,MAAM,oBAAoB;MAAC,MAAM;QAAqB,CAAA;EAC1E;AACF;AAEA,SAAS,2CAAqB,MAAqB;AACjD,WAAS,IAAI,GAAG,IAAI,KAAK,SAAS,QAAQ,KAAK;AAC7C,QAAI,UAAU,KAAK,SAAS,CAAA;AAC5B,QAAI,CAAC,QAAQ,SAAS,MACpB,QAAO;EAEX;AAEA,SAAO;AACT;;;ACrHO,SAAS,0CAAS,OAAqB;AAC5C,MAAI,EAAA,IACA,OAEF,mBAAmB,gBACnB,cAAc,WAAS,mBACJ,QAAA,IACjB;AAEJ,QAAK,GAAA,2CAAM,EAAA;AACX,MAAI,WAAU,GAAA,2CAAI;AAClB,MAAI,aAAa,CAAC;AAClB,MAAI,OAAO;AACT,qBAAiB,iBAAiB,GAAG,OAAA,IAAW,cAAA,KAAmB;AACnE,iBAAa;MACX,IAAI;MACJ,SAAS,qBAAqB,UAAU,KAAK;IAC/C;EACF,WAAW,CAAC,kBAAkB,CAAC,aAAa,KAC1C,SAAQ,KAAK,sHAAA;AAGf,MAAI,cAAa,GAAA,2CAAU;;IAEzB,cAAc;IACd,mBAAmB;EACrB,CAAA;AAEA,SAAO;;;EAGP;AACF;;;ACtCO,SAAS,0CAAS,OAAqB;AAC5C,MAAI,EAAA,aAAY,cAAc,WAAW,gBAAiB,IAAI;AAC9D,MAAI,EAAA,YAAW,WAAY,KAAI,GAAA,2CAAS,KAAA;AAExC,MAAI,iBAAgB,GAAA,2CAAU;IAAC,QAAQ,WAAA;IAAc,QAAQ,YAAA;IAAe;IAAW;GAAgB;AACvG,MAAI,kBAAiB,GAAA,2CAAU;IAAC,QAAQ,WAAA;IAAc,QAAQ,YAAA;IAAe;IAAW;GAAgB;AAExG,gBAAa,GAAA,2CAAW,YAAY;IAClC,oBAAoB;MAClB;;MAEA;MACA,MAAM,kBAAA;MACN,OAAO,OAAA,EAAS,KAAK,GAAA,KAAQ;EACjC,CAAA;AAEA,SAAO;;;IAGL,kBAAkB;MAChB,IAAI;IACN;IACA,mBAAmB;MACjB,IAAI;IACN;EACF;AACF;",
  "names": ["$9Gacy$useRef", "$9Gacy$useEffect"]
}
